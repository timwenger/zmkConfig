/*
 * Copyright (c) 2020 The ZMK Contributors
 *
 * SPDX-License-Identifier: MIT
 * Edited by Tim Wenger
 * 
 * This is the COLEMAK branch
 *
 */

#include <behaviors.dtsi>
#include <dt-bindings/zmk/keys.h>
#include <dt-bindings/zmk/bt.h>
#include <dt-bindings/zmk/outputs.h>

#define DEFAULT 0
#define L1      1
#define L2      2
#define BTL     3

&lt {
    tapping-term-ms = <250>;
    quick_tap_ms = <180>;

};

/ {	
	behaviors {
        hm: homerow_mods {
            compatible = "zmk,behavior-hold-tap";
            label = "HOMEROW_MODS";
            #binding-cells = <2>;
            tapping-term-ms = <250>;
            quick-tap-ms = <180>;
            flavor = "tap-preferred";
            bindings = <&kp>, <&kp>;
        };
	};
	
    combos {
	   compatible = "zmk,combos";
		
	   // left hand top row
	   
	   combo_exclamation_mark {
		  timeout-ms = <200>;            // longer for pinky fingers
		  key-positions = <1 2>;
		  bindings = <&kp EXCLAMATION>;
		  layers = <0>;
	   };
	   combo_at_symbol {
		  timeout-ms = <50>;
		  key-positions = <2 3>;
		  bindings = <&kp AT_SIGN>;
		  layers = <0>;
	   };
	   combo_dollar_symbol {
		  timeout-ms = <50>;
		  key-positions = <3 4>;
		  bindings = <&kp DOLLAR>;
		  layers = <0>;
	   };
	   combo_hash_symbol {
		  timeout-ms = <50>;
		  key-positions = <4 5>;
		  bindings = <&kp HASH>;
		  layers = <0>;
	   };
	   
	   // right hand top row
	   
	   combo_percent_symbol {
		  timeout-ms = <50>;
		  key-positions = <6 7>;
		  bindings = <&kp PERCENT>;
		  layers = <0>;
	   };
	   combo_and_symbol {
		  timeout-ms = <50>;
		  key-positions = <7 8>;
		  bindings = <&kp AMPERSAND>;
		  layers = <0>;
	   };
	   combo_or_symbol {
		  timeout-ms = <50>;
		  key-positions = <8 9>;
		  bindings = <&kp PIPE2>;
		  layers = <0>;
	   };
	   combo_caret_symbol {
		  timeout-ms = <150>;             // longer for pinky fingers
		  key-positions = <9 10>;
		  bindings = <&kp CARET>;
		  layers = <0>;
	   };
	};
	
    keymap {
        compatible = "zmk,keymap";
        base_layer {
         
            bindings = <
                &none       &kp Q         &kp W         &kp F          &kp P           &kp G                 &kp J         &kp L          &kp U         &kp Y           &kp SEMI        &none
                &none       &kp A         &hm LWIN R    &hm LALT S     &hm LCTRL T     &kp D                 &kp H         &hm RCTRL N    &hm RALT E    &hm LWIN I      &kp O           &none
                &none       &kp Z         &kp X         &kp C          &kp V           &kp B                 &kp K         &kp M          &kp COMMA     &kp DOT         &kp FSLH        &none
                                                        &lt L1 TAB     &lt L2 BSPC     &kp LSHFT             &kp RSHFT     &lt L2 SPACE   &lt L1 ENTER
            >; 
        };
    	
        layer_1 {
            
    		bindings = <
                &none       &kp ESC       &kp PG_DN     &kp UP         &kp PG_UP       &kp PRINTSCREEN       &kp F12       &kp F7         &kp F8        &kp F9          &none           &none
                &none       &kp HOME      &hm LWIN LEFT &hm LALT DOWN  &hm LCTRL RIGHT &kp END               &kp F11       &hm RCTRL F4   &hm RALT F5   &hm LWIN F6     &none           &none
                &none       &kp C_MUTE    &kp C_VOL_DN  &kp C_PP       &kp C_VOL_UP    &none                 &kp F10       &kp F1         &kp F2        &kp F3          &none           &none
                                                        &mo BTL        &none           &kp LSHFT             &kp RSHFT     &none          &mo BTL
            >;
        };
    
        layer_2 {

    		bindings = <
                &none       &kp GRAVE     &kp TILDE     &kp LBKT       &kp RBKT        &kp EQUAL             &kp PLUS      &kp N7         &kp N8        &kp N9          &kp ASTERISK    &none
                &none       &kp BSLH      &hm LWIN FSLH &hm LALT LPAR  &hm LCTRL RPAR  &kp SQT               &kp MINUS     &hm RCTRL N4   &hm RALT N5   &hm LWIN N6     &kp SLASH       &none
                &none       &none         &none         &kp LBRC       &kp RBRC        &kp DQT               &kp N0        &kp N1         &kp N2        &kp N3          &kp PERIOD      &none
                                                        &none          &kp DELETE      &kp LSHFT             &kp RSHFT     &none          &none
            >;
        };
	bluetooth_layer {

    		bindings = <
                &none       &bt BT_CLR    &out OUT_USB  &out OUT_BLE   &none           &none                 &reset        &none          &none         &none           &bootloader     &none
                &none       &bt BT_SEL 3  &bt BT_SEL 2  &bt BT_SEL 1   &bt BT_SEL 0    &none                 &none         &none          &none         &none           &none           &none
                &none       &none         &none         &none          &none           &none&none            &none         &none          &none         &none           &none           &none
                                                        &none          &none           &none                 &none         &none          &none
            >;
        };
    };
};
